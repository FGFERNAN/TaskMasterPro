<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskMaster - Registrar Tiempo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../../public/assets/css/registrarTiempo.css">
</head>

<body class="bg-custom">
    <div class="registrar-tiempo-content">
        <img src="../../public/assets/img/logos/logotipo.png" alt="TaskMaster Logo">
        <h2>Registrar Tiempo <i class="fas fa-clock" style="margin-left: 10px;"></i></h2> <!-- Ícono de reloj -->
        <button class="btn btn-regresar justify-content-end" onclick="history.back()"><svg
            xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
            class="bi bi-caret-left-fill" viewBox="0 0 16 16">
            <path
                d="m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z" />
        </svg> Regresar</button>
    </div>

    <div class="clock-container">
        <div class="time-display">
            <div id="time">6:40</div>
            <span id="am-pm">AM</span>
        </div>
        <div class="clock" id="clock">
            <div class="hand" id="hour-hand"></div>
            <div class="hand" id="minute-hand"></div>
            <div class="hand-circle"></div>
            <div class="number number12">12</div>
            <div class="number number1">1</div>
            <div class="number number2">2</div>
            <div class="number number3">3</div>
            <div class="number number4">4</div>
            <div class="number number5">5</div>
            <div class="number number6">6</div>
            <div class="number number7">7</div>
            <div class="number number8">8</div>
            <div class="number number9">9</div>
            <div class="number number10">10</div>
            <div class="number number11">11</div>
        </div>
        <div class="buttons">
            <a href="#" id="cancel">CANCEL</a>
            <a href="#" id="ok">OK</a>
        </div>
    </div>
    <div class="calendar-wrapper">
        <div id="calendar"></div>
    </div>

    <!-- Contenedor de la lista de tareas -->
    <div class="task-list-container">
        <h3 class="lista">Tarea 1</h3>
        <ul class="task-list">
            <li>
                <div class="task-details">
                    <p>Fecha: 4 de junio</p>
                    <p>Duración: 3 horas</p>
                    <p>Tarea: Tarea 1</p>
                    <p>Miembro: User234</p>
                </div>
                <button class="btn btn-primary btn-action">Descargar</button>
            </li>
            <li>
                <div class="task-details">
                    <p>Fecha: 4 de junio</p>
                    <p>Duración: 3 horas</p>
                    <p>Tarea: Tarea 2</p>
                    <p>Miembro: User235</p>
                </div>
                <button class="btn btn-primary btn-action">Descargar</button>
            </li>
            <li>
                <div class="task-details">
                    <p>Fecha: 4 de junio</p>
                    <p>Duración: 3 horas</p>
                    <p>Tarea: Tarea 3</p>
                    <p>Miembro: User236</p>
                </div>
                <button class="btn btn-primary btn-action">Descargar </button>
            </li>
            <!-- Agrega más tareas aquí si es necesario -->
        </ul>
    </div>
    <div class="text-center mt-4">
        <button class="btn btn-guardar btn-action">Guardar registro</button>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
        // Inicializa el calendario de Flatpickr
        flatpickr("#calendar", {
            inline: true,
            dateFormat: "d-m-Y",
        });

        // Inicializa las manecillas del reloj
        function initializeClock() {
            const hourHand = document.getElementById("hour-hand");
            const minuteHand = document.getElementById("minute-hand");
            let currentHour = new Date().getHours();
            let currentMinute = new Date().getMinutes();

            function updateClock() {
                const hourDegrees = (currentHour % 12) * 30 + (currentMinute / 60) * 30;
                const minuteDegrees = currentMinute * 6;

                hourHand.style.transform = `rotate(${hourDegrees}deg)`;
                minuteHand.style.transform = `rotate(${minuteDegrees}deg)`;

                document.getElementById("time").textContent = `${currentHour < 10 ? "0" : ""}${currentHour}:${currentMinute < 10 ? "0" : ""}${currentMinute}`;
                document.getElementById("am-pm").textContent = currentHour >= 12 ? "PM" : "AM";
            }

            updateClock();
            setInterval(updateClock, 1000);

            // Funciones para arrastrar las manecillas
            let isDraggingHour = false;
            let isDraggingMinute = false;

            hourHand.addEventListener("mousedown", () => {
                isDraggingHour = true;
            });

            minuteHand.addEventListener("mousedown", () => {
                isDraggingMinute = true;
            });

            document.addEventListener("mousemove", (event) => {
                if (isDraggingHour || isDraggingMinute) {
                    const rect = hourHand.parentElement.getBoundingClientRect();
                    const centerX = rect.left + rect.width / 2;
                    const centerY = rect.top + rect.height / 2;

                    const mouseX = event.clientX - centerX;
                    const mouseY = event.clientY - centerY;
                    const angle = Math.atan2(mouseY, mouseX) * (180 / Math.PI) + 90;

                    if (isDraggingHour) {
                        hourHand.style.transform = `rotate(${angle}deg)`;
                    } else if (isDraggingMinute) {
                        minuteHand.style.transform = `rotate(${angle}deg)`;
                    }
                }
            });

            document.addEventListener("mouseup", () => {
                if (isDraggingHour) {
                    const hourDegrees = parseFloat(hourHand.style.transform.replace("rotate(", "").replace("deg)", ""));
                    currentHour = Math.round((hourDegrees / 30) % 12);
                    if (currentHour === 0) currentHour = 12; // Ajustar para mostrar 12 en lugar de 0
                    updateClock();
                } else if (isDraggingMinute) {
                    const minuteDegrees = parseFloat(minuteHand.style.transform.replace("rotate(", "").replace("deg)", ""));
                    currentMinute = Math.round((minuteDegrees / 6) % 60);
                    updateClock();
                }

                isDraggingHour = false;
                isDraggingMinute = false;
            });
        }

        // Inicializa el reloj
        initializeClock();

        // Función para mostrar alerta cuando se registre el tiempo
        document.querySelector(".btn-guardar").addEventListener("click", function () {
            // Obtén la hora actual seleccionada en el reloj
            const selectedTime = document.getElementById("time").textContent + " " + document.getElementById("am-pm").textContent;

            // Obtén la fecha seleccionada en el calendario
            const selectedDate = document.querySelector(".flatpickr-day.selected").ariaLabel;

            // Muestra el mensaje de alerta
            alert(`Se registró su tiempo exitosamente:\nFecha: ${selectedDate}\nHora: ${selectedTime}`);
        });
    </script>

</body>
</html>