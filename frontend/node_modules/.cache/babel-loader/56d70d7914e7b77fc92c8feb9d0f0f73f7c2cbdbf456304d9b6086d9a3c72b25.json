{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport api from '@/services/api';\nexport default {\n  mounted() {\n    document.title = \"Usuarios | TaskMaster Pro\";\n    this.getUsers();\n  },\n  data() {\n    return {\n      searchQuery: '',\n      users: []\n    };\n  },\n  computed: {\n    filteredUser() {\n      return this.users.filter(user => user.nombre.toLowerCase().includes(this.searchQuery.toLowerCase()));\n    }\n  },\n  methods: {\n    async getUsers() {\n      try {\n        const response = await api.get('/user');\n        this.users = response.data.data;\n        console.log(response.data);\n      } catch (error) {\n        if (error.response && error.response.data) {\n          const serverErrors = error.response.data;\n          if (serverErrors.message === 'Error fetching users: ') {\n            console.log(serverErrors.message);\n            alert(serverErrors.message);\n          } else if (serverErrors.mensaje === 'Usuario no autenticado') {\n            console.log(serverErrors.mensaje);\n            alert(`${serverErrors.mensaje}, debes loguearte para acceder a esta ruta.`);\n            this.$router.push('/iniciar-sesion');\n          } else if (serverErrors.mensaje === 'No tienes permisos para realizar esta acción.') {\n            console.log(serverErrors.mensaje);\n            alert(serverErrors.mensaje);\n          } else {\n            console.log('Ocurrio un error inesperado del lado del servidor: ', serverErrors);\n            alert('Ocurrio un error inesperado del lado del servidor, revisa la consola para obtener más detalles');\n          }\n        }\n      }\n    },\n    // Redirige a la página de crear usuario\n    redirectToRecoveruser() {\n      console.log('Redirigiendo a crear-usuario');\n      this.$router.push('/crear-usuario');\n    },\n    // Redirige a la página de editar usuario\n    redirectToEditUser(userId) {\n      this.$router.push({\n        name: 'EditarUsuario',\n        params: {\n          id: userId\n        }\n      });\n    },\n    async deleteUser(userId) {\n      try {\n        if (confirm('¿Estás seguro que deseas eliminar el rol?')) {\n          const response = await api.delete(`/role/${userId}}`);\n          this.roles = this.roles.filter(role => user.id !== userId);\n          console.log(response.data.message);\n          alert(response.data.message);\n        }\n      } catch (error) {\n        if (error.response && error.response.data) {\n          const serverErrors = error.response.data;\n          if (serverErrors.message === 'Role not exists') {\n            console.log(serverErrors.message);\n            alert(serverErrors.message);\n          } else if (serverErrors.message === 'Rol no eliminado') {\n            console.log(serverErrors.message);\n            alert(serverErrors.message);\n          } else if (serverErrors.message === 'Error deleting role: ') {\n            console.log('Ocurrio un error inesperado del lado del servidor: ', serverErrors);\n            alert('Ocurrio un error inesperado del lado del servidor, revisa la consola para obtener más detalles');\n          }\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["api","mounted","document","title","getUsers","data","searchQuery","users","computed","filteredUser","filter","user","nombre","toLowerCase","includes","methods","response","get","console","log","error","serverErrors","message","alert","mensaje","$router","push","redirectToRecoveruser","redirectToEditUser","userId","name","params","id","deleteUser","confirm","delete","roles","role"],"sources":["C:\\xampp\\htdocs\\TaskMasterPro\\trim03\\04_prototipo_funcional\\TaskMaster_Pro\\frontend\\src\\components\\administrarUsuarios.vue"],"sourcesContent":["<template>\r\n  <div class=\"bg-custom\">\r\n    <!-- Navbar for mobile -->\r\n    <nav class=\"navbar navbar-expand-lg navbar-light bg-light d-lg-none\">\r\n      <div class=\"container-fluid\">\r\n        <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"offcanvas\" data-bs-target=\"#offcanvasMenu\"\r\n          aria-controls=\"offcanvasMenu\">\r\n          <span class=\"navbar-toggler-icon\"></span>\r\n        </button>\r\n        <a class=\"navbar-brand\" href=\"#\">Menú</a>\r\n      </div>\r\n    </nav>\r\n\r\n    <!-- Offcanvas for mobile menu -->\r\n    <div class=\"offcanvas offcanvas-start\" tabindex=\"-1\" id=\"offcanvasMenu\" aria-labelledby=\"offcanvasMenuLabel\">\r\n      <div class=\"offcanvas-header\">\r\n        <h5 class=\"offcanvas-title\" id=\"offcanvasMenuLabel\">Menú</h5>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"offcanvas\" aria-label=\"Close\"></button>\r\n      </div>\r\n      <div class=\"offcanvas-body\">\r\n        <ul class=\"nav flex-column\">\r\n          <!-- Usamos router-link para redirigir en Vue -->\r\n          <li class=\"nav-item\">\r\n            <router-link to=\"/perfil-completo\" class=\"nav-link mi-link\">\r\n              <i class=\"fa-solid fa-home me-1\"></i> Inicio\r\n            </router-link>\r\n          </li>\r\n          <li class=\"nav-item\">\r\n            <router-link to=\"/administrar-usuarios\" class=\"nav-link mi-link\">\r\n              <i class=\"fa-solid fa-user-cog me-1\"></i> Usuarios\r\n            </router-link>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"container-fluid\">\r\n      <div class=\"row\">\r\n        <!-- Sidebar for larger screens -->\r\n        <div class=\"col-md-3 custom-col d-none d-lg-block\">\r\n          <img src=\"../assets/img/logos/logotipo.png\" class=\"logo-inicio\" width=\"300\" />\r\n          <ul class=\"nav flex-column\">\r\n            <li class=\"nav-item\">\r\n              <router-link to=\"/perfil-completo\" class=\"nav-link mi-link\">\r\n                <i class=\"fa-solid fa-home me-1\"></i> Inicio\r\n              </router-link>\r\n            </li>\r\n            <li class=\"nav-item\">\r\n              <router-link to=\"/administrar-usuarios\" class=\"nav-link mi-link\">\r\n                <i class=\"fa-solid fa-user-cog me-1\"></i> Usuarios\r\n              </router-link>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n\r\n        <div class=\"col custom-col-main\">\r\n          <header>\r\n            <div class=\"header d-flex justify-content-end align-items-center p-3\">\r\n              <div class=\"d-flex align-items-center\">\r\n                <span>Administrador</span>\r\n                <a href=\"perfil.html\" class=\"ms-3\">\r\n                  <img src=\"../assets/img/mariposa34.jpg\" alt=\"Perfil\" class=\"rounded-circle\" width=\"40\" />\r\n                </a>\r\n              </div>\r\n            </div>\r\n          </header>\r\n\r\n          <section class=\"container-fluid mt-4\">\r\n            <div class=\"d-flex justify-content-between align-items-center mb-3\">\r\n              <div class=\"d-flex align-items-center\">\r\n                <h2>Usuarios</h2>\r\n                <!-- Usamos router-link para redirigir -->\r\n                <button class=\"btn btn-success ms-3\" @click=\"redirectToRecoveruser\"><i\r\n                    class=\"fa-solid fa-plus me-1\"></i></button>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Table responsive container -->\r\n            <div class=\"table-responsive\">\r\n              <table class=\"table table-striped\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>ID</th>\r\n                    <th>Nombre</th>\r\n                    <th>Email</th>\r\n                    <th>Telefono</th>\r\n                    <th>Rol</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr v-for=\"(user) in filteredUser\" :key=\"user.id\">\r\n                    <td>{{ user.id }}</td>\r\n                    <td>{{ user.nombre }} {{ user.apellidos }}</td>\r\n                    <td>{{ user.email }}</td>\r\n                    <td>{{ user.telefono }}</td>\r\n                    <td>\r\n                      <select class=\"form-select\" disabled>\r\n                        <option :value=\"user.rolID\">{{ user.rolID }}</option>\r\n                      </select>\r\n                    </td>\r\n                    <td>\r\n                      <!-- Usamos el método redirectToEditUser para redirigir a editar usuario -->\r\n                      <button class=\"btn btn-sm btn-secondary\" @click=\"redirectToEditUser(user.id)\"><i\r\n                          class=\"fa-solid fa-pen\"></i></button>\r\n                      <button class=\"btn btn-sm btn-danger btn-eliminar\"><i class=\"fa-solid fa-trash\"></i></button>\r\n                    </td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </section>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport api from '@/services/api';\r\nexport default {\r\n  mounted() {\r\n    document.title = \"Usuarios | TaskMaster Pro\";\r\n    this.getUsers();\r\n  },\r\n  data() {\r\n    return {\r\n      searchQuery: '',\r\n      users: []\r\n    };\r\n  },\r\n  computed: {\r\n    filteredUser() {\r\n      return this.users.filter(user => user.nombre.toLowerCase().includes(this.searchQuery.toLowerCase()));\r\n    }\r\n  },\r\n  methods: {\r\n    async getUsers() {\r\n      try {\r\n        const response = await api.get('/user');\r\n        this.users = response.data.data;\r\n        console.log(response.data);\r\n      } catch (error) {\r\n        if (error.response && error.response.data) {\r\n          const serverErrors = error.response.data;\r\n          if (serverErrors.message === 'Error fetching users: ') {\r\n            console.log(serverErrors.message);\r\n            alert(serverErrors.message);\r\n          } else if (serverErrors.mensaje === 'Usuario no autenticado') {\r\n            console.log(serverErrors.mensaje);\r\n            alert(`${serverErrors.mensaje}, debes loguearte para acceder a esta ruta.`);\r\n            this.$router.push('/iniciar-sesion');\r\n          } else if (serverErrors.mensaje === 'No tienes permisos para realizar esta acción.') {\r\n            console.log(serverErrors.mensaje);\r\n            alert(serverErrors.mensaje);\r\n          } else {\r\n            console.log('Ocurrio un error inesperado del lado del servidor: ', serverErrors);\r\n            alert('Ocurrio un error inesperado del lado del servidor, revisa la consola para obtener más detalles');\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    // Redirige a la página de crear usuario\r\n    redirectToRecoveruser() {\r\n      console.log('Redirigiendo a crear-usuario');\r\n      this.$router.push('/crear-usuario');\r\n    },\r\n    // Redirige a la página de editar usuario\r\n    redirectToEditUser(userId) {\r\n      this.$router.push({ name: 'EditarUsuario', params: { id: userId }});\r\n    },\r\n    async deleteUser(userId) {\r\n      try {\r\n        if (confirm('¿Estás seguro que deseas eliminar el rol?')) {\r\n        const response =  await api.delete(`/role/${userId}}`);\r\n        this.roles = this.roles.filter(role => user.id !== userId);\r\n        console.log(response.data.message);\r\n        alert(response.data.message);\r\n      }\r\n      } catch (error) {\r\n        if(error.response && error.response.data){\r\n          const serverErrors = error.response.data;\r\n          if(serverErrors.message === 'Role not exists'){\r\n            console.log(serverErrors.message);\r\n            alert(serverErrors.message);\r\n          } else if (serverErrors.message === 'Rol no eliminado'){\r\n            console.log(serverErrors.message);\r\n            alert(serverErrors.message);\r\n          } else if(serverErrors.message === 'Error deleting role: '){\r\n            console.log('Ocurrio un error inesperado del lado del servidor: ', serverErrors);\r\n            alert('Ocurrio un error inesperado del lado del servidor, revisa la consola para obtener más detalles');\r\n          }\r\n        }\r\n      }\r\n      \r\n    }\r\n  }\r\n};\r\n</script>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}